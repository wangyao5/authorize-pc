angular.module("app.controller", [])    .controller('index', ['$scope', '$state', '$stateParams', 'service', function($scope, $state, $stateParams, service) {          console.log("into index");    }])    .controller('company', ['$scope', '$state', '$stateParams', 'service', function($scope, $state, $stateParams, service) {          var hasCompanyArray = [];          service.getCompany().then(function(data){              angular.forEach(data, function(item,index,array){                  item['index'] = index;                  hasCompanyArray.push(item);              });            $scope.companyArray = hasCompanyArray;          });          $scope.search = function(searchText){              var searchResult = [];              angular.forEach(hasCompanyArray.concat(addCompanyArray), function(item, index, array){                  if (item.name.indexOf(searchText) > -1) {                      item.index = index;                      searchResult.push(item);                  }              });              $scope.companyArray = searchResult;          }          $scope.switch = function(index) {             $scope.companyArray[index].editer = true;          }          var addCompanyArray = [];          $scope.add = function() {            var currentIndex = hasCompanyArray.length + addCompanyArray.length;            addCompanyArray.push({name:'', index:currentIndex, ableSave:true});            $scope.companyArray = hasCompanyArray.concat(addCompanyArray);          }          $scope.save = function() {          }          $scope.edited = function(index){            checkIsAdded(index);            if(index < hasCompanyArray.length) {                hasCompanyArray[index].ableSave = true;            }          }          var checkIsAdded = function(editeItemIndex) {              if (editeItemIndex < hasCompanyArray.length) {                if (hasCompanyArray[editeItemIndex] == $scope.companyArray[editeItemIndex]) {                    $scope.companyArray[editeItemIndex].editer = false;                }              }              var allCompany = hasCompanyArray.concat(addCompanyArray);              angular.forEach(allCompany, function(item, index, array){                  if (editeItemIndex != index) {                      if (item.name == allCompany[editeItemIndex].name) {                          alert("hasCompany");                      }                  }              });          }    }])    .controller('wfop', ['$scope', '$state', '$stateParams', 'service', function($scope, $state, $stateParams, service) {        var hasWorkFlowOpArray = []        service.getWorkFlowOp().then(function(data){            angular.forEach(data, function(item,index,array){                  item['index'] = index;                  hasWorkFlowOpArray.push(item);              });             $scope.workFlowOpArray = hasWorkFlowOpArray;        });        $scope.currentWorkFlowNameDisplay = "全部";        var hasWorkFlowNameArray = [];        service.getWorkFlowName().then(function(data) {            hasWorkFlowNameArray = data;            $scope.workFlowNameArray = hasWorkFlowNameArray;        })        $scope.currentWorkFlowBCategoryDisplay = "全部";        var currentWorkFlowBCategory = [];        var hasWorkFlowBCategoryArray = [];        service.getWorkFlowBCategory().then(function(data){            hasWorkFlowBCategoryArray = data;            initWorkFlowBCategory(hasWorkFlowBCategoryArray);        })        $scope.currentWorkFlowLCategoryDisplay = "全部";        var currentWorkFlowLCategoryArray = [];        var hasWorkFLowLCategoryArray = [];        service.getWorkFlowLCategory().then(function(data){            hasWorkFLowLCategoryArray = data;            initWorkFlowLCategory(hasWorkFLowLCategoryArray);        })        var hasWorkFlowOp = [];        service.getWorkFlowOp().then(function(data){            angular.forEach(data, function(item,index,array){                  item['index'] = index;                  hasWorkFlowOp.push(item);              });            $scope.workFlowOp = hasWorkFlowOp;        });        $scope.workFlowNameChecked = function(index){            $scope.currentWorkFlowNameDisplay = $scope.workFlowNameArray[index];            $scope.currentWorkFlowBCategoryDisplay = "全部";            $scope.currentWorkFlowLCategoryDisplay = "全部";            initWorkFlowBCategory(hasWorkFlowBCategoryArray);            initWorkFlowLCategory(hasWorkFLowLCategoryArray);        }        $scope.workFlowBCategoryChecked = function(index){            $scope.currentWorkFlowBCategoryDisplay = $scope.workFlowBCategoryArray[index];        }        $scope.workFlowLCategoryChecked = function(index){            $scope.currentWorkFlowLCategoryDisplay = $scope.workFlowLCategoryArray[index];        }        $scope.search = function(workFlowName, workFlowBCategory, workFlowLCategory) {            console.log("workFlowName:" + workFlowName);            console.log("workFlowBCategory:" + workFlowBCategory);            console.log("workFlowLCategory:" + workFlowLCategory);        }        $scope.reset = function() {            $scope.currentWorkFlowNameDisplay = "全部";            $scope.currentWorkFlowBCategoryDisplay = "全部";            $scope.currentWorkFlowLCategoryDisplay = "全部";        }        var addWorkFlowOpArray = []        $scope.add = function() {            var currentIndex = hasWorkFlowOpArray.length + addWorkFlowOpArray.length;            addWorkFlowOpArray.push({workFlowName:'', BCategory:'', LCategory:'', index:currentIndex, ableSave:true});            $scope.workFlowOpArray = hasWorkFlowOpArray.concat(addWorkFlowOpArray);        }        $scope.save = function() {                    }        $scope.switch = function(index) {            $scope.workFlowOpArray[index].editer = true;        }        $scope.edited = function(index) {            checkIsAdded(index);            if(index < hasWorkFlowOpArray.length) {                hasWorkFlowOpArray[index].ableSave = true;            }        }        var initWorkFlowBCategory = function(workFlowBCategoryArray) {            angular.forEach(workFlowBCategoryArray, function(item, index, array){                if (item.workFlowName == $scope.currentWorkFlowNameDisplay) {                    currentWorkFlowBCategoryArray = item.BCategory;                    return;                }            });            $scope.workFlowBCategoryArray = currentWorkFlowBCategoryArray;        }        var initWorkFlowLCategory = function(workFlowLCategoryArray) {            angular.forEach(workFlowLCategoryArray, function(item, index, array){                if (item.workFlowName == $scope.currentWorkFlowNameDisplay) {                    currentWorkFlowLCategoryArray = item.LCategory;                    return;                }            });            $scope.workFlowLCategoryArray = currentWorkFlowLCategoryArray;        }        var checkIsAdded = function(editeItemIndex) {              if (editeItemIndex < hasWorkFlowOpArray.length) {                if (hasWorkFlowOpArray[editeItemIndex] == $scope.workFlowOpArray[editeItemIndex]) {                    $scope.workFlowOpArray[editeItemIndex].editer = false;                }              }              var allWorkFlowOpArray = hasWorkFlowOpArray.concat(addWorkFlowOpArray);              angular.forEach(allWorkFlowOpArray, function(item, index, array){                  if (editeItemIndex != index) {                      if (item.workFlowName == allWorkFlowOpArray[editeItemIndex].workFlowName && item.BCategory == allWorkFlowOpArray[editeItemIndex].BCategory && item.LCategory == allWorkFlowOpArray[editeItemIndex].LCategory) {                          alert("duplicated");                      }                  }              });          }    }])    .controller('search', ['$scope', '$state', '$stateParams', 'service', function($scope, $state, $stateParams, service) {    }]);